[nltk_data] Downloading package punkt to /vol/fob-
[nltk_data]     vol3/nebenf20/wubingti/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
/usr/lib64/python3.6/site-packages/h5py/__init__.py:39: UserWarning: h5py is running against HDF5 1.10.8 when it was built against 1.10.7, this may cause problems
  '{0}.{1}.{2}'.format(*version.hdf5_built_version_tuple)
datasets imported
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.dense.bias', 'lm_head.layer_norm.weight', 'lm_head.dense.weight', 'lm_head.bias', 'lm_head.decoder.weight', 'lm_head.layer_norm.bias']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
There are 3 GPU(s) available.
We will use the GPU: NVIDIA A100 80GB PCIe
/vol/fob-vol3/nebenf20/wubingti/.local/lib/python3.6/site-packages/transformers/optimization.py:309: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  FutureWarning,
##########
ECtHR_BERT_head_text_rank_5
----------
Epoch 1/40
time = 302.59 secondes

/usr/lib64/python3.6/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/usr/lib64/python3.6/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Train loss 0.2931086676346289 micro_f1_score 0.5576556912645707 
 
time = 10.68 secondes

Val loss 0.2661563561099475 micro_f1_score 0.5555555555555556
 
----------
Epoch 2/40
time = 280.18 secondes

Train loss 0.19224067996214103 micro_f1_score 0.7313714789471475 
 
time = 11.39 secondes

Val loss 0.21599331571430455 micro_f1_score 0.6894409937888198
 
----------
Epoch 3/40
time = 288.52 secondes

Train loss 0.16438872096304957 micro_f1_score 0.7817712388836523 
 
time = 11.70 secondes

Val loss 0.20245889928497252 micro_f1_score 0.7155240346729709
 
----------
Epoch 4/40
time = 285.70 secondes

Train loss 0.14539037417653983 micro_f1_score 0.8115414188013437 
 
time = 12.15 secondes

Val loss 0.20540884857783553 micro_f1_score 0.7188096146508965
 
----------
Epoch 5/40
time = 297.18 secondes

Train loss 0.1301311618841446 micro_f1_score 0.8379008277746522 
 
time = 11.67 secondes

Val loss 0.2256095354430011 micro_f1_score 0.7152066742510428
 
----------
Epoch 6/40
time = 295.62 secondes

Train loss 0.1189565085075997 micro_f1_score 0.8548400032079558 
 
time = 12.20 secondes

Val loss 0.2247115895152092 micro_f1_score 0.7202111613876319
 
----------
Epoch 7/40
time = 298.04 secondes

Train loss 0.10746491433935122 micro_f1_score 0.8732002227348661 
 
time = 12.52 secondes

Val loss 0.2202711596352155 micro_f1_score 0.7358983937243184
 
----------
Epoch 8/40
time = 298.82 secondes

Train loss 0.09614303042222788 micro_f1_score 0.8886342985817565 
 
time = 11.11 secondes

Val loss 0.2290063174288781 micro_f1_score 0.7339992600813912
 
----------
Epoch 9/40
time = 290.58 secondes

Train loss 0.08927880731486791 micro_f1_score 0.9003104247711108 
 
time = 11.38 secondes

Val loss 0.23980288073176242 micro_f1_score 0.7370317002881844
 
----------
Epoch 10/40
time = 288.44 secondes

Train loss 0.07910870614352528 micro_f1_score 0.9138262404393018 
 
time = 10.80 secondes

Val loss 0.2724143366833202 micro_f1_score 0.722466960352423
 
----------
Epoch 11/40
time = 288.67 secondes

Train loss 0.07312297073134162 micro_f1_score 0.9203574355172279 
 
time = 11.19 secondes

Val loss 0.2714640075554613 micro_f1_score 0.735740072202166
 
----------
Epoch 12/40
time = 290.12 secondes

Train loss 0.06512120179999788 micro_f1_score 0.9318208305815624 
 
time = 11.21 secondes

Val loss 0.2911356567237221 micro_f1_score 0.7291518175338562
 
----------
Epoch 13/40
time = 289.59 secondes

Train loss 0.05701835391254307 micro_f1_score 0.9412904475876768 
 
time = 11.38 secondes

Val loss 0.30346116240395876 micro_f1_score 0.7388489208633094
 
----------
Epoch 14/40
time = 287.12 secondes

Train loss 0.05216097786124829 micro_f1_score 0.9455120784132129 
 
time = 10.74 secondes

Val loss 0.3050906448090663 micro_f1_score 0.7341060765718299
 
----------
Epoch 15/40
time = 287.23 secondes

Train loss 0.04629767635283438 micro_f1_score 0.9530371853106474 
 
time = 11.61 secondes

Val loss 0.3201402712796555 micro_f1_score 0.739929328621908
 
----------
Epoch 16/40
time = 294.06 secondes

Train loss 0.040676893742948035 micro_f1_score 0.9581334663647877 
 
time = 9.51 secondes

Val loss 0.35602441686587255 micro_f1_score 0.7314487632508834
 
----------
Epoch 17/40
time = 288.95 secondes

Train loss 0.0370075063903707 micro_f1_score 0.9619981612013484 
 
time = 10.93 secondes

Val loss 0.349295194520325 micro_f1_score 0.7413671599718111
 
----------
Epoch 18/40
time = 290.63 secondes

Train loss 0.03308783082085922 micro_f1_score 0.9656017773691873 
 
time = 11.33 secondes

Val loss 0.35560196809104233 micro_f1_score 0.7390530437878249
 
----------
Epoch 19/40
time = 292.79 secondes

Train loss 0.0286811212160591 micro_f1_score 0.9706095929677049 
 
time = 11.79 secondes

Val loss 0.3969454036140051 micro_f1_score 0.7315530569219958
 
----------
Epoch 20/40
time = 291.12 secondes

Train loss 0.026162264933379635 micro_f1_score 0.9721872496280187 
 
time = 11.09 secondes

Val loss 0.38023502526224634 micro_f1_score 0.7497330010679958
 
----------
Epoch 21/40
time = 291.74 secondes

Train loss 0.022912034274525688 micro_f1_score 0.9754830825632017 
 
time = 11.58 secondes

Val loss 0.4065752741499025 micro_f1_score 0.7306569343065693
 
----------
Epoch 22/40
time = 289.82 secondes

Train loss 0.020532060848461958 micro_f1_score 0.9782923299565847 
 
time = 11.40 secondes

Val loss 0.41502158050654364 micro_f1_score 0.7389090909090908
 
----------
Epoch 23/40
time = 296.51 secondes

Train loss 0.018704842289895038 micro_f1_score 0.9802636592242627 
 
time = 11.49 secondes

Val loss 0.44410359505258623 micro_f1_score 0.7312522425547182
 
----------
Epoch 24/40
time = 291.32 secondes

Train loss 0.017167026794325194 micro_f1_score 0.9820395738203958 
 
time = 9.33 secondes

Val loss 0.4502000957727432 micro_f1_score 0.7385503065272269
 
----------
Epoch 25/40
time = 287.59 secondes

Train loss 0.01426043985155883 micro_f1_score 0.9846095238095237 
 
time = 11.38 secondes

Val loss 0.4653716556361464 micro_f1_score 0.7372184483375045
 
----------
Epoch 26/40
time = 289.96 secondes

Train loss 0.013298616706631471 micro_f1_score 0.9858650512439516 
 
time = 11.09 secondes

Val loss 0.4652958879949617 micro_f1_score 0.7384070796460178
 
----------
Epoch 27/40
time = 288.44 secondes

Train loss 0.012092778611042524 micro_f1_score 0.987205848754855 
 
time = 10.83 secondes

Val loss 0.49287325094957823 micro_f1_score 0.7396576319543509
 
----------
Epoch 28/40
time = 289.99 secondes

Train loss 0.01024328878343809 micro_f1_score 0.9889976015532799 
 
time = 11.39 secondes

Val loss 0.5059040137490288 micro_f1_score 0.7322249734701096
 
----------
Epoch 29/40
time = 288.61 secondes

Train loss 0.009440907495907694 micro_f1_score 0.990259493189255 
 
time = 11.13 secondes

Val loss 0.5166981598881425 micro_f1_score 0.7336213102951764
 
----------
Epoch 30/40
time = 288.60 secondes

Train loss 0.008534940719035657 micro_f1_score 0.9909875651214967 
 
time = 11.30 secondes

Val loss 0.5283227379693359 micro_f1_score 0.7320028510334996
 
----------
Epoch 31/40
time = 287.56 secondes

Train loss 0.007037337792962307 micro_f1_score 0.9926641073396937 
 
time = 11.16 secondes

Val loss 0.5288544732039092 micro_f1_score 0.7425919314530525
 
----------
Epoch 32/40
time = 287.44 secondes

Train loss 0.006954920481953892 micro_f1_score 0.9930048661800487 
 
time = 10.75 secondes

Val loss 0.5541704797842464 micro_f1_score 0.7323943661971832
 
----------
Epoch 33/40
time = 284.89 secondes

Train loss 0.006367611050852763 micro_f1_score 0.9936542919025725 
 
time = 10.70 secondes

Val loss 0.5395980881618672 micro_f1_score 0.7416370106761565
 
----------
Epoch 34/40
time = 286.97 secondes

Train loss 0.006055710979932415 micro_f1_score 0.9941431505286377 
 
time = 11.32 secondes

Val loss 0.5533631798185286 micro_f1_score 0.7420977011494252
 
----------
Epoch 35/40
time = 287.99 secondes

Train loss 0.004680825865940639 micro_f1_score 0.9950570342205323 
 
time = 11.55 secondes

Val loss 0.5654505237204129 micro_f1_score 0.7398230088495575
 
----------
Epoch 36/40
time = 287.81 secondes

Train loss 0.004509133514087201 micro_f1_score 0.9956288722490402 
 
time = 11.71 secondes

Val loss 0.5839864316045261 micro_f1_score 0.7355666429080541
 
----------
Epoch 37/40
time = 281.06 secondes

Train loss 0.0037092900767461984 micro_f1_score 0.9965050904117916 
 
time = 11.39 secondes

Val loss 0.56308307229984 micro_f1_score 0.7436619718309858
 
----------
Epoch 38/40
time = 283.16 secondes

Train loss 0.002638991983189339 micro_f1_score 0.9974164133738601 
 
time = 11.72 secondes

Val loss 0.590242689994515 micro_f1_score 0.7326033203814906
 
----------
Epoch 39/40
time = 284.12 secondes

Train loss 0.0027905757912407895 micro_f1_score 0.997149914497435 
 
time = 11.00 secondes

Val loss 0.5698249682051236 micro_f1_score 0.7425742574257428
 
----------
Epoch 40/40
time = 282.24 secondes

Train loss 0.002123764777002794 micro_f1_score 0.9978344287831009 
 
time = 11.60 secondes

Val loss 0.5932061007765473 micro_f1_score 0.743437171858593
 
----------
best_f1_socre 0.7497330010679958 best_epoch 20

average train time 289.54410461187365

average val time 11.254662948846818
 
time = 12.61 secondes

test_f1_score 0.7375043691017126

----------
