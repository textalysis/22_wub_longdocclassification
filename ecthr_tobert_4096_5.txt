[nltk_data] Downloading package punkt to /vol/fob-
[nltk_data]     vol3/nebenf20/wubingti/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
/usr/lib64/python3.6/site-packages/h5py/__init__.py:39: UserWarning: h5py is running against HDF5 1.10.8 when it was built against 1.10.7, this may cause problems
  '{0}.{1}.{2}'.format(*version.hdf5_built_version_tuple)
datasets imported
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.dense.bias', 'lm_head.bias', 'lm_head.decoder.weight', 'lm_head.layer_norm.bias', 'lm_head.dense.weight', 'lm_head.layer_norm.weight']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
There are 3 GPU(s) available.
We will use the GPU: NVIDIA A100 80GB PCIe
/vol/fob-vol3/nebenf20/wubingti/.local/lib/python3.6/site-packages/transformers/optimization.py:309: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  FutureWarning,
##########
ECtHR_ToBERT_256_25_5
----------
Epoch 1/40
time = 872.41 secondes

/usr/lib64/python3.6/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in samples with no predicted labels. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Train loss 0.20188214514438096 micro_f1_score 0.7292232021709633 
 
time = 47.02 secondes

/usr/lib64/python3.6/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
Val loss 0.16693402252724912 micro_f1_score 0.7523584905660377
 
----------
Epoch 2/40
time = 907.96 secondes

Train loss 0.13810392957147177 micro_f1_score 0.8190383365821963 
 
time = 45.87 secondes

Val loss 0.16454078770074687 micro_f1_score 0.7698713096139288
 
----------
Epoch 3/40
time = 868.92 secondes

Train loss 0.12017572690472678 micro_f1_score 0.8484434625426793 
 
time = 42.27 secondes

Val loss 0.15967882058170976 micro_f1_score 0.7874669686674217
 
----------
Epoch 4/40
time = 860.72 secondes

Train loss 0.10616013344360499 micro_f1_score 0.871269771704052 
 
time = 42.17 secondes

Val loss 0.1616175809233892 micro_f1_score 0.78833775085195
 
----------
Epoch 5/40
time = 832.33 secondes

Train loss 0.09516388042536271 micro_f1_score 0.8872132708945155 
 
time = 42.03 secondes

Val loss 0.15921526487733498 micro_f1_score 0.79536101758324
 
----------
Epoch 6/40
time = 825.20 secondes

Train loss 0.08407768475831495 micro_f1_score 0.9020196830164815 
 
time = 40.60 secondes

Val loss 0.16947314045468315 micro_f1_score 0.7938645716423494
 
----------
Epoch 7/40
time = 845.16 secondes

Train loss 0.07492513491579139 micro_f1_score 0.9129680725266063 
 
time = 40.19 secondes

Val loss 0.1729732271833498 micro_f1_score 0.7967359050445104
 
----------
Epoch 8/40
time = 803.63 secondes

Train loss 0.0665936797712552 micro_f1_score 0.925857674965693 
 
time = 36.31 secondes

Val loss 0.18437675746982216 micro_f1_score 0.8007476635514018
 
----------
Epoch 9/40
time = 820.56 secondes

Train loss 0.059148562621946135 micro_f1_score 0.9341139734582358 
 
time = 38.42 secondes

Val loss 0.20002037854712518 micro_f1_score 0.7882136279926335
 
----------
Epoch 10/40
time = 802.14 secondes

Train loss 0.05161215100114377 micro_f1_score 0.9439285020400233 
 
time = 36.03 secondes

Val loss 0.20441658703274415 micro_f1_score 0.793178519593614
 
----------
Epoch 11/40
time = 809.79 secondes

Train loss 0.04583719750375462 micro_f1_score 0.9508387246736141 
 
time = 36.75 secondes

Val loss 0.2161762933628481 micro_f1_score 0.791184971098266
 
----------
Epoch 12/40
time = 796.55 secondes

Train loss 0.03883438372883845 micro_f1_score 0.9572748714379616 
 
time = 35.15 secondes

Val loss 0.23261635219220256 micro_f1_score 0.7800356506238859
 
----------
Epoch 13/40
time = 821.80 secondes

Train loss 0.03383573716651095 micro_f1_score 0.9652298074325628 
 
time = 35.44 secondes

Val loss 0.24355198186440546 micro_f1_score 0.7932031814895155
 
----------
Epoch 14/40
time = 806.29 secondes

Train loss 0.029364053973286237 micro_f1_score 0.9693492491336156 
 
time = 42.65 secondes

Val loss 0.2549876652535845 micro_f1_score 0.7881597717546363
 
----------
Epoch 15/40
time = 860.61 secondes

Train loss 0.025218556420500013 micro_f1_score 0.9737307012827405 
 
time = 43.21 secondes

Val loss 0.26412412768504656 micro_f1_score 0.7936842105263159
 
----------
Epoch 16/40
time = 803.16 secondes

Train loss 0.02120638778417472 micro_f1_score 0.9788002150702819 
 
time = 41.12 secondes

Val loss 0.2800413364025413 micro_f1_score 0.7905027932960894
 
----------
Epoch 17/40
time = 857.79 secondes

Train loss 0.02040986817147633 micro_f1_score 0.9802298850574713 
 
time = 40.01 secondes

Val loss 0.277308246395627 micro_f1_score 0.7875000000000001
 
----------
Epoch 18/40
time = 805.04 secondes

Train loss 0.016875047966033462 micro_f1_score 0.9822734407902293 
 
time = 41.42 secondes

Val loss 0.2968038784675911 micro_f1_score 0.7897146882705177
 
----------
Epoch 19/40
time = 835.63 secondes

Train loss 0.013725041285582487 micro_f1_score 0.986129685529785 
 
time = 42.04 secondes

Val loss 0.3009731630321409 micro_f1_score 0.7970244420828905
 
----------
Epoch 20/40
time = 826.90 secondes

Train loss 0.010874255760905841 micro_f1_score 0.9889338319468823 
 
time = 40.98 secondes

Val loss 0.299614529690293 micro_f1_score 0.7978533094812164
 
----------
Epoch 21/40
time = 826.45 secondes

Train loss 0.010020651029107456 micro_f1_score 0.9902786779001945 
 
time = 43.65 secondes

Val loss 0.3133033140883094 micro_f1_score 0.7966954022988506
 
----------
Epoch 22/40
time = 843.72 secondes

Train loss 0.008569702285295772 micro_f1_score 0.9918060901711193 
 
time = 43.11 secondes

Val loss 0.32620248998530577 micro_f1_score 0.7971119133574007
 
----------
Epoch 23/40
time = 830.27 secondes

Train loss 0.007539845057718586 micro_f1_score 0.9928386408654579 
 
time = 45.15 secondes

Val loss 0.3375286402516678 micro_f1_score 0.7942477876106195
 
----------
Epoch 24/40
time = 857.78 secondes

Train loss 0.006996840906025567 micro_f1_score 0.9937916587316701 
 
time = 45.71 secondes

Val loss 0.3375174304867377 micro_f1_score 0.7983988355167394
 
----------
Epoch 25/40
time = 837.70 secondes

Train loss 0.0059521621326345114 micro_f1_score 0.9949794614331355 
 
time = 45.35 secondes

Val loss 0.337713198186677 micro_f1_score 0.8062130177514792
 
----------
Epoch 26/40
time = 871.44 secondes

Train loss 0.0048833466086196835 micro_f1_score 0.9960462287104622 
 
time = 45.82 secondes

Val loss 0.3468901739440492 micro_f1_score 0.7994000749906262
 
----------
Epoch 27/40
time = 838.25 secondes

Train loss 0.004691019128589327 micro_f1_score 0.9958916615946439 
 
time = 47.66 secondes

Val loss 0.3568676750435204 micro_f1_score 0.8025055268975682
 
----------
Epoch 28/40
time = 878.95 secondes

Train loss 0.0037329272216198774 micro_f1_score 0.9968058407483459 
 
time = 47.07 secondes

Val loss 0.3636402186067378 micro_f1_score 0.8053791557713859
 
----------
Epoch 29/40
time = 836.40 secondes

Train loss 0.003112727087244747 micro_f1_score 0.9976057462090981 
 
time = 52.42 secondes

Val loss 0.3691328126387518 micro_f1_score 0.7973997833152763
 
----------
Epoch 30/40
time = 901.54 secondes

Train loss 0.002520636583492658 micro_f1_score 0.9983286484843881 
 
time = 52.67 secondes

Val loss 0.38314414317490625 micro_f1_score 0.7959034381858084
 
----------
Epoch 31/40
time = 872.80 secondes

Train loss 0.002545804498793193 micro_f1_score 0.9981376610543119 
 
time = 52.71 secondes

Val loss 0.3737397946295191 micro_f1_score 0.8014787430683918
 
----------
Epoch 32/40
time = 898.69 secondes

Train loss 0.0017221921095451843 micro_f1_score 0.998593637158387 
 
time = 52.40 secondes

Val loss 0.37697739477773184 micro_f1_score 0.7999999999999998
 
----------
Epoch 33/40
time = 884.33 secondes

Train loss 0.0016743918756112982 micro_f1_score 0.998556560054699 
 
time = 52.66 secondes

Val loss 0.3865657345559753 micro_f1_score 0.7927056196501675
 
----------
Epoch 34/40
time = 820.20 secondes

Train loss 0.0015395196443089001 micro_f1_score 0.9988224121557455 
 
time = 40.79 secondes

Val loss 0.3848625160753727 micro_f1_score 0.796875
 
----------
Epoch 35/40
time = 832.00 secondes

Train loss 0.0014295601169750797 micro_f1_score 0.9988223226835846 
 
time = 41.60 secondes

Val loss 0.386463709969501 micro_f1_score 0.7976146105106224
 
----------
Epoch 36/40
time = 810.70 secondes

Train loss 0.0010707168432115093 micro_f1_score 0.9992402947656309 
 
time = 42.00 secondes

Val loss 0.38740250663679154 micro_f1_score 0.8001499812523435
 
----------
Epoch 37/40
time = 861.04 secondes

Train loss 0.0008574317076013645 micro_f1_score 0.9994682063359417 
 
time = 42.72 secondes

Val loss 0.3874283198450432 micro_f1_score 0.7989477639984968
 
----------
Epoch 38/40
time = 824.68 secondes

Train loss 0.0008448504695078153 micro_f1_score 0.9993544712359977 
 
time = 43.12 secondes

Val loss 0.3914087298707884 micro_f1_score 0.7932710280373833
 
----------
Epoch 39/40
time = 844.33 secondes

Train loss 0.0008778753551424571 micro_f1_score 0.9994301561372184 
 
time = 42.81 secondes

Val loss 0.3905351009280955 micro_f1_score 0.7968923418423974
 
----------
Epoch 40/40
time = 801.98 secondes

Train loss 0.0008249908955754968 micro_f1_score 0.9995061353189226 
 
time = 43.45 secondes

Val loss 0.3946995649669991 micro_f1_score 0.7954461990451708
 
----------
best_f1_socre 0.8062130177514792 best_epoch 25

average train time 840.8964512944221

average val time 43.3143734395504
 
time = 47.61 secondes

test_f1_score 0.7902046783625731

----------
Some weights of the model checkpoint at roberta-base were not used when initializing RobertaModel: ['lm_head.dense.bias', 'lm_head.bias', 'lm_head.decoder.weight', 'lm_head.layer_norm.bias', 'lm_head.dense.weight', 'lm_head.layer_norm.weight']
- This IS expected if you are initializing RobertaModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing RobertaModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
There are 3 GPU(s) available.
We will use the GPU: NVIDIA A100 80GB PCIe
##########
ECtHR_ToBERT_256_50_5
----------
Epoch 1/40
time = 769.11 secondes

Train loss 0.20158733702726192 micro_f1_score 0.7306182738974467 
 
time = 43.85 secondes

Val loss 0.16424476440812721 micro_f1_score 0.7579693034238488
 
----------
Epoch 2/40
time = 783.53 secondes

Train loss 0.13591617920545038 micro_f1_score 0.822996684725479 
 
time = 44.51 secondes

Val loss 0.16200589071043203 micro_f1_score 0.7678776290630975
 
----------
Epoch 3/40
time = 806.74 secondes

Train loss 0.11741819175648259 micro_f1_score 0.8533429475623923 
 
time = 43.76 secondes

Val loss 0.1643417644940439 micro_f1_score 0.7882662655133509
 
----------
Epoch 4/40
time = 839.38 secondes

Train loss 0.10369573213697017 micro_f1_score 0.8752440530740726 
 
time = 51.23 secondes

Val loss 0.1806370546338988 micro_f1_score 0.7731154845896769
 
----------
Epoch 5/40
time = 878.15 secondes

Train loss 0.09376142745971813 micro_f1_score 0.8891796518774038 
 
time = 53.26 secondes

Val loss 0.17698781766363833 micro_f1_score 0.7850812407680946
 
----------
Epoch 6/40
time = 898.27 secondes

Train loss 0.08268185719713435 micro_f1_score 0.9039106586164714 
 
time = 53.22 secondes

Val loss 0.17810817276600932 micro_f1_score 0.7808883911907429
 
----------
Epoch 7/40
time = 879.43 secondes

Train loss 0.07364596287082244 micro_f1_score 0.9166175256516099 
 
time = 53.54 secondes

Val loss 0.19153022692828883 micro_f1_score 0.7836343531146334
 
----------
Epoch 8/40
time = 813.99 secondes

Train loss 0.06504035200965633 micro_f1_score 0.9286470795904759 
 
time = 42.47 secondes

Val loss 0.19252138633708485 micro_f1_score 0.7908163265306123
 
----------
Epoch 9/40
time = 742.47 secondes

Train loss 0.05729539897104071 micro_f1_score 0.9395076201641266 
 
time = 43.01 secondes

Val loss 0.21016485622671785 micro_f1_score 0.7881202462875769
 
----------
Epoch 10/40
time = 828.06 secondes

Train loss 0.05097514381611233 micro_f1_score 0.9460961486145116 
 
time = 44.02 secondes

Val loss 0.21023548712007334 micro_f1_score 0.7852062588904694
 
----------
Epoch 11/40
time = 838.96 secondes

Train loss 0.04466824271854617 micro_f1_score 0.954259532499806 
 
time = 44.48 secondes

Val loss 0.23063461372598273 micro_f1_score 0.7827941699253466
 
----------
Epoch 12/40
time = 834.05 secondes

Train loss 0.03849807646710778 micro_f1_score 0.9588882006813255 
 
time = 44.40 secondes

Val loss 0.25290540740138195 micro_f1_score 0.7761403508771929
 
----------
Epoch 13/40
time = 832.07 secondes

Train loss 0.03320263216779609 micro_f1_score 0.9662141314409132 
 
time = 42.33 secondes

Val loss 0.27608815751603394 micro_f1_score 0.7742601514108741
 
----------
Epoch 14/40
time = 820.92 secondes

Train loss 0.02831375743398812 micro_f1_score 0.9707525721552156 
 
time = 42.99 secondes

Val loss 0.27856855399784497 micro_f1_score 0.7756843227870601
 
----------
Epoch 15/40
time = 830.06 secondes

Train loss 0.024385279604613463 micro_f1_score 0.9746864661075633 
 
time = 42.68 secondes

Val loss 0.2967805536921884 micro_f1_score 0.7808510638297872
 
----------
Epoch 16/40
time = 815.42 secondes

Train loss 0.020193917662857587 micro_f1_score 0.9799578463307147 
 
time = 42.34 secondes

Val loss 0.29765515621812616 micro_f1_score 0.7784473590925204
 
----------
Epoch 17/40
time = 827.73 secondes

Train loss 0.01723287145865175 micro_f1_score 0.9824884086293444 
 
time = 41.94 secondes

Val loss 0.31757009676733955 micro_f1_score 0.7794221282593374
 
----------
Epoch 18/40
time = 831.48 secondes

Train loss 0.014671509292416918 micro_f1_score 0.985422963614799 
 
time = 41.66 secondes

Val loss 0.3226194078805017 micro_f1_score 0.7758865248226952
 
----------
Epoch 19/40
Exception
CUDA out of memory. Tried to allocate 664.00 MiB (GPU 0; 79.20 GiB total capacity; 57.14 GiB already allocated; 507.31 MiB free; 57.45 GiB reserved in total by PyTorch)
